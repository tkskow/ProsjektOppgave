\chapter{DNS Tunneling Detection}
\label{chp:dns_detection}

There has been done some research in detecting \Gls{dns} tunneling over the years, but as it is still a problem no one has found a solution that is cost efficient. The best way for detecting tunnels is still \Gls{dpi} which is slows down the \Gls{dns} requests as the amount of requests increase. \Gls{dpi} looks into each request and response for payload information which can indicate a \Gls{dns} tunnel. For instance if requests maximizes the size of the labels and the overall name it should be looked at \cite{farnham2013detecting}, this since tunnels would try to minimize the number of packages and maximize speed. Looking at the hostname should also be an indication since regular \Gls{dns} names is dictionary words or have some meaning, while an encoded name would be meaningless. Traffic analysis is the other main alternative to detecting tunnels. Looking at volume, frequency and other attributes of \Gls{dns} traffic could give indication of a tunnel. Earlier research has covered different techniques, looking at the volume of \Gls{dns} traffic from a IP address or the volume of \Gls{dns} traffic to a specific domain \cite{farnham2013detecting}. The overarching way of detecting tunnels with traffic analysis is looking for anomalies and stand out cases.

\subsection{Traffic analysis}
Data that is tunnelled through \Gls{dns} is normally limited to 512 bytes per request, which leads to clients to send and receive lots of requests and responses. If the server should have the possibility to send data to the client will the client have to constantly send requests to get the data as a response from the server. All this leads to lots of \Gls{dns} traffic which is not similar to normal use.
